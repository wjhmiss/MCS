## 推荐技术栈
### 后端
核心框架：.NET 8 + Orleans 8.x + sqlsugar ORM 框架 + 集成swagger查看接口 + SignalR 前后端实时通信 + K8S 生产部署。

功能要求：开发一个工作流管理系统，功能如下：

1，可以创建工作流和任务，一个工作流可以由一个或多个任务组成。任务不能单独启动和执行，只有工作流可以。

2，每个任务可以通过API和MQTT与外部设备进行通信，可以调用和接收外部API和发布订阅外部MQTT。任务与任务之间可以通过双向通信。

3，一个工作流中，可以设置任务并联和串联执行。

4，一个工作流中，上一个任务可以根据外部API和外部MQTT，本程序命令跳到指定的后续任务中继续执行，也可以终止后面的所有任务。

5，一个工作流中，任务执行时间可以长时间等待，直到满足上个任务通过后，再执行下一个任务。

6，需要设计合理的可视化界面和看板界面，可以实时监控各个工作流的工作情况，还需要有统计面板等，用vue3 setup开发。

7，采用 Orleans Silo 服务和web api 分离部署的方式，不要在同一个进程中。

8，一个工作流可以设置自动循环执行，设置定时启动，也可以由外部调用API或mqtt等启动和终止。

9，需加入重试Polly 框架

框架设计如下：
1. MCS.API：作为Web API项目，负责处理HTTP请求，实现RESTful接口，不包含Orleans Silo功能，需通过Orleans客户端与Silo集群通信。
2. MCS.Grains：作为Orleans Grain接口和实现项目，包含所有Grain接口定义及具体业务逻辑实现，需设计合理的Grain ID生成策略和状态管理方案。
3. MCS.Silo：作为Orleans Silo服务项目，负责承载Grain运行时环境，配置集群通信方式，实现Silo节点发现机制，确保高可用性和可扩展性。

补充
1，工作流执行顺序只有串行和并行两种。
2，启动工作流可以由外部API，外部MQTT，或其他工作流中的任务，或定时，或人工按钮手动启动。
3，工作流中的任务，可以长时间等待，直到接收外部API，外部MQTT，或其他工作流中的任务指令后才触发执行。
4，工作流中的任务，除了接收外部API，外部MQTT，或其他工作流中的任务指令外，也可以调用外部API，发布MQTT，或对其他工作流中发布指令

技术选型如下：

1，存储方案：

业务数据存储为 Postgres：
- PostgreSQL
postgres 链接地址：192.168.137.219 端口：5432   密码：sa@3397，需新建数据库MCS

Orleans Silo 及Grain 持久化 为 Postgres和redis
-Postgres 存储，地址为：链接地址：192.168.137.219 端口：5432   密码：sa@3397 ，已新建数据库OrleansDB
-redis地址：192.168.137.219 端口：6379




2，消息通信：
- MQTTnet - 外部触发和设备通信
- Orleans Streams - 内部事件流转

MQTT地址：192.168.137.219 MQTT 监听器(端口1883),WebSocket 监听器（端口 9001）

### 前端
框架：Vue 3 + TypeScript + Vite

核心组件：
- Element Plus - UI 组件库
- AntV X6 - 流程图可视化编辑器
- Pinia - 状态管理
- SignalR Client - 实时通信

### 部署
容器化：Kubernetes




